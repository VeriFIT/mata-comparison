# This file is part of Awali.
# Copyright 2016-2021 Sylvain Lombardy, Victor Marsault, Jacques Sakarovitch
#
# Awali is a free software: you can redistribute it and/or modify
# it under the terms of the GNU General Public License as published by
# the Free Software Foundation, either version 3 of the License, or
# (at your option) any later version.
#
# This program is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
# GNU General Public License for more details.
#
# You should have received a copy of the GNU General Public License
# along with this program. If not, see <http://www.gnu.org/licenses/>.


configure_file("${CMAKE_CURRENT_SOURCE_DIR}/config.hh.in"
               "${CMAKE_CURRENT_BINARY_DIR}/config.hh")

install( FILES "${CMAKE_CURRENT_BINARY_DIR}/config.hh"
         DESTINATION "${AWALICPP_HEADER_INSTALL_PREFIX}/awali/dyn")

add_custom_target(check-dyn DEPENDS awalidyn COMMAND "${CMAKE_CTEST_COMMAND}" COMMENT "Launching test suite for 'dyn' layer")
add_subdirectory(tests EXCLUDE_FROM_ALL)
add_subdirectory(examples EXCLUDE_FROM_ALL)

add_custom_target(cleanlib 
  COMMAND rm -rf "$ENV{HOME}/${AWALI_MODULE_SUFFIX}"
  DEPENDS cleandep
  COMMENT "Removing local compiled module ($ENV{HOME}/${AWALI_MODULE_SUFFIX})"
)
add_custom_target(cleandep 
  COMMAND rm -rf "${AWALI_TMP_DIR}"
  COMMENT "Removing autogenerated module dependencies (${AWALI_TMP_DIR})"
)


# FOREACH(FILE aliases.cc tdc-eval.cc random.cc tdc-circulation.cc sys.cc)
#   set(AWALIDYN_SOURCES ${CMAKE_CURRENT_SOURCE_DIR}/algos/${FILE} ${AWALIDYN_SOURCES} PARENT_SCOPE)
# ENDFOREACH()
# 
# FOREACH(F accessible.cc eliminate.cc  minimize.cc ratexp.cc are-equivalent.cc eval.cc output.cc singleproduct.cc automaton.cc factor.cc partial-id.cc standard.cc context.cc factories.cc product.cc transducer.cc derivation.cc graph.cc promotion.cc proper.cc transpose.cc determinize.cc history.cc quotient.cc)
#   set(AWALIDYN_SOURCES 
#       "${CMAKE_CURRENT_SOURCE_DIR}/modules/${F} " 
#       ${AWALIDYN_SOURCES} 
#      PARENT_SCOPE)
# ENDFOREACH()
